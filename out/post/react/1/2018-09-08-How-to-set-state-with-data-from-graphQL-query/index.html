<!DOCTYPE html><html lang="en"><head><meta name="author" content="Moondaddi"/><link rel="manifest" href="/static/manifest.json"/><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="Build my dreams with codes"/><meta name="theme-color" content="black"/><meta charSet="utf-8" class="next-head"/><title class="jsx-1819391530 next-head">Moondaddi&#x27;s Blog</title><link rel="preload" href="/_next/static/ppfu4rpZUOMljsYC9ZmK9/pages/post.js" as="script"/><link rel="preload" href="/_next/static/ppfu4rpZUOMljsYC9ZmK9/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-f0c6edbea5b547edc23f.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.298c115416bea8464748.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-ea256225ecf9df19827a.js" as="script"/><style id="__jsx-79190987">#menu-button.jsx-79190987{display:none;}#header.jsx-79190987 #home-title.jsx-79190987{display:inline-block;}#header.jsx-79190987 #home-title-sm.jsx-79190987{display:none;}#header.jsx-79190987{grid-area:header;background-color:#343d46;box-shadow:0 4px 8px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);z-index:20;}#header-top.jsx-79190987{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:72px;}.make-fixed.jsx-79190987{position:fixed;top:0;left:0;width:100vw;}#header.jsx-79190987 #home-title.jsx-79190987 a.jsx-79190987{font-size:1.2rem;font-weight:bold;-webkit-text-decoration:none;text-decoration:none;color:#eee;margin:0 10px;padding:15px;}#header.jsx-79190987 #home-title.jsx-79190987:hover a.jsx-79190987{cursor:pointer;color:#fff;}#header.jsx-79190987 #home-title-sm.jsx-79190987 a.jsx-79190987{font-size:1.2rem;font-weight:bold;-webkit-text-decoration:none;text-decoration:none;color:#eee;margin:0 10px;padding:15px;}#header.jsx-79190987 #home-title-sm.jsx-79190987:hover a.jsx-79190987{cursor:pointer;color:#fff;}#header.jsx-79190987 a#menu-about.jsx-79190987{display:inline-block;-webkit-text-decoration:none;text-decoration:none;color:#eee;padding:15px;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;}#header.jsx-79190987 a#menu-about.jsx-79190987:hover{background-color:white;-webkit-transition:0.2s;transition:0.2s;cursor:pointer;color:#000;border-bottom:4px solid #aaa;padding:15px 15px 11px 15px;}#search-button-sm.jsx-79190987{color:#4f5b66;margin:0px 10px;padding:20px 15px 19px 15px;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;}#search-button-sm.jsx-79190987:hover{background-color:white;-webkit-transition:0.2s;transition:0.2s;cursor:pointer;color:#000;border-bottom:4px solid #aaa;padding:20px 15px 15px 15px;}#header.jsx-79190987 a#home-title.jsx-79190987:hover{background-color:unset;color:#fff;-webkit-transition:0.2s;transition:0.2s;}.search-container.jsx-79190987{display:inline-block;vertical-align:middle;white-space:nowrap;position:relative;padding:10px;}.search-container.jsx-79190987 input#search.jsx-79190987{width:20px;height:50px;background:#2b303b;border:none;font-size:1rem;float:left;color:#262626;padding-left:35px;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;color:#2b303b;-webkit-transition:width 0.55s ease;-moz-transition:width 0.55s ease;-ms-transition:width 0.55s ease;-o-transition:width 0.55s ease;-webkit-transition:width 0.55s ease;transition:width 0.55s ease;}.search-container.jsx-79190987 input#search.jsx-79190987::-webkit-input-placeholder{color:#65737e;}.search-container.jsx-79190987 input#search.jsx-79190987:-moz-placeholder{color:#65737e;}.search-container.jsx-79190987 input#search.jsx-79190987::-moz-placeholder{color:#65737e;}.search-container.jsx-79190987 input#search.jsx-79190987:-ms-input-placeholder{color:#65737e;}.search-container.jsx-79190987 .icon.jsx-79190987{position:absolute;margin-left:20px;margin-top:15px;z-index:1;color:#4f5b66;}.search-container.jsx-79190987:hover .icon.jsx-79190987,.search-container.jsx-79190987 input#search.jsx-79190987:focus .icon.jsx-79190987,.search-container.jsx-79190987 input#search.jsx-79190987:active .icon.jsx-79190987{margin-top:17px;color:#93a2ad;-webkit-transform:scale(1.5);-moz-transform:scale(1.5);-ms-transform:scale(1.5);-o-transform:scale(1.5);-webkit-transform:scale(1.5);-ms-transform:scale(1.5);transform:scale(1.5);}.search-container.jsx-79190987 input#search.jsx-79190987:focus,.search-container.jsx-79190987 input#search.jsx-79190987:active{outline:none;width:150px;padding-left:50px;color:white;}.search-container.jsx-79190987:hover input#search.jsx-79190987{width:150px;padding-left:50px;color:white;}.search-container.jsx-79190987:hover .icon.jsx-79190987{color:#93a2ad;}#header-bottom.jsx-79190987,#search-button-sm.jsx-79190987{display:none;}@media (max-width:576px){#menu-button.jsx-79190987{display:inline-block;color:#eee;margin-right:10px;padding:15px;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;}#menu-button.jsx-79190987:hover{background-color:white;-webkit-transition:0.2s;transition:0.2s;cursor:pointer;color:#000;border-bottom:4px solid #aaa;padding:15px 15px 11px 15px;}#header.jsx-79190987 #home-title.jsx-79190987{display:none;}#header.jsx-79190987 #home-title-sm.jsx-79190987{display:inline-block;}#search-container-id.jsx-79190987{display:none;}#search-button-sm.jsx-79190987{display:inline-block;}#header-bottom.jsx-79190987{display:block;}.search-container.jsx-79190987{padding-top:0px;}.search-container.jsx-79190987 input#search.jsx-79190987{width:200px;padding-left:50px;color:white;}.search-container.jsx-79190987:hover input#search.jsx-79190987{width:200px;padding-left:50px;color:white;}.search-container.jsx-79190987 input#search.jsx-79190987:focus,.search-container.jsx-79190987 input#search.jsx-79190987:active{outline:none;width:200px;padding-left:50px;color:white;}}</style><style id="__jsx-2114829803">#category.jsx-2114829803,#category__show.jsx-2114829803{grid-area:category;background-color:#eee;padding:15px 0;}.make-fixed-category.jsx-2114829803{position:fixed;top:87px;left:0;width:100%;display:grid;grid-template-columns:300px 1fr;grid-template-areas:"category-fixed content-fixed";}#container-category-fixed.jsx-2114829803{grid-area:category-fixed;}#menu-close-button.jsx-2114829803{display:none;}@media (max-width:576px){#category.jsx-2114829803{display:none;}#category__show.jsx-2114829803{grid-area:2/1/3/2;z-index:10;background-color:rgba(238,238,238,0.97);}#menu-close-button.jsx-2114829803{display:block;margin-right:10px;padding:10px;font-size:2rem;color:#555;cursor:pointer;text-align:right;}.make-fixed-category.jsx-2114829803{display:block;}}#category.jsx-2114829803 a.jsx-2114829803,#category__show.jsx-2114829803 a.jsx-2114829803{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:0;padding:15px 30px;color:#555;-webkit-text-decoration:none;text-decoration:none;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}#category.jsx-2114829803 a.jsx-2114829803:hover,#category__show.jsx-2114829803 a.jsx-2114829803:hover{background-color:#ddd;-webkit-transition:0.5s;transition:0.5s;}#category.jsx-2114829803 a#selected.jsx-2114829803,#category__show.jsx-2114829803 a#selected.jsx-2114829803{color:#000;font-weight:bold;}</style><style id="__jsx-1792980523">.footer-container.jsx-1792980523{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.footer-left-span.jsx-1792980523{width:70px;}.copyright.jsx-1792980523{color:#999;font-size:0.8rem;text-align:center;padding:10px;}.footer-right-span.jsx-1792980523{color:#fff;font-size:1.5rem;text-align:right;}.footer-right-span.jsx-1792980523 a.jsx-1792980523:link,.footer-right-span.jsx-1792980523 a.jsx-1792980523:visited,.footer-right-span.jsx-1792980523 a.jsx-1792980523:hover,.footer-right-span.jsx-1792980523 a.jsx-1792980523:active{color:#fff;}.footer-right-span.jsx-1792980523 i.jsx-1792980523{padding-right:10px;}</style><style id="__jsx-1819391530">html,body{margin:0;padding:0;border:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI", Helvetica,Arial,sans-serif,"Apple Color Emoji", "Segoe UI Emoji","Segoe UI Symbol";font-size:1rem;font-weight:300;line-height:160%;}#layout{display:grid;grid-template-columns:300px 1fr;grid-template-areas:"header header" "category content" "footer footer";}#footer{grid-area:footer;background-color:#eee;}#content{grid-area:content;display:grid;grid-template-columns:minmax(auto,100px) 1fr minmax(auto,100px);grid-template-areas:"left-span container right-span";padding:50px 0px;background:radial-gradient(black 15%,transparent 16%) 0 0, radial-gradient(black 15%,transparent 16%) 8px 8px, radial-gradient(rgba(255,255,255,0.1) 15%,transparent 20%) 0 1px, radial-gradient(rgba(255,255,255,0.1) 15%,transparent 20%) 8px 9px;background-color:#282828;background-size:16px 16px;}@media (max-width:576px){#layout{display:grid;grid-template-columns:1fr;grid-template-areas:"header" "content" "footer";}#content{grid-area:content;display:grid;grid-template-columns:1fr;grid-template-areas:"container";padding:50px 0px;}img{width:100%;}}.container{grid-area:container;padding:20px 10px 20px 10px;min-width:0;}.add-padding-for-fixed-header{padding:90px 10px 20px 10px;}.index-h2-title{display:inline-block;border:5px solid #2c3e50;border-radius:35px;padding:10px 20px;background-color:#fff;}.pinned{border:5px solid #e74c3c;}#latest{color:#f39c12;}#pinned{color:#e74c3c;}.post-card{background-color:#fff;border:1px solid #eee;padding:20px;margin-bottom:50px;border-radius:5px;box-shadow:0 4px 8px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);}img{width:100%;max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content;}blockquote{margin:0;padding:0 1em;color:#6a737d;border-left:0.25em solid #dfe2e5;word-break:break-word;}code{color:#c0392b;padding:2px 3px;border:1px solid #ccc;border-radius:3px;}pre code{overflow:auto;word-wrap:normal;white-space:pre;}.hljs-comment,.hljs-quote{color:#d4d0ab;}.hljs-variable,.hljs-template-variable,.hljs-tag,.hljs-name,.hljs-selector-id,.hljs-selector-class,.hljs-regexp,.hljs-deletion{color:#ffa07a;}.hljs-number,.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-type,.hljs-params,.hljs-meta,.hljs-link{color:#f5ab35;}.hljs-attribute{color:#ffd700;}.hljs-string,.hljs-symbol,.hljs-bullet,.hljs-addition{color:#abe338;}.hljs-title,.hljs-section{color:#00e0e0;}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0;}.hljs{display:block;overflow-x:auto;background:#2b2b2b;color:#f8f8f2;padding:1rem;font-size:1rem;border-radius:5px;}.hljs-emphasis{font-style:italic;}.hljs-strong{font-weight:bold;}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-string,.hljs-symbol,.hljs-type,.hljs-quote{color:highlight;}.hljs-keyword,.hljs-selector-tag{font-weight:bold;}}@media (max-width:576px){pre{width:calc(100vw - 60px);}}</style></head><body><div id="__next"><div id="layout" class="jsx-1819391530"><div id="header" class="jsx-79190987"><div id="header-top" class="jsx-79190987"><div id="home" class="jsx-79190987"><div id="home-title" class="jsx-79190987"><a class="jsx-79190987" href="/">Build my Dreams with Codes</a></div><div id="home-title-sm" class="jsx-79190987"><a class="jsx-79190987" href="/">BDC</a></div></div><div id="menu" class="jsx-79190987"><a id="menu-about" class="jsx-79190987" href="/about/">About</a><i id="search-button-sm" class="jsx-79190987 fa fa-search"></i><div id="search-container-id" class="jsx-79190987 search-container"><span class="jsx-79190987 icon"><i class="jsx-79190987 fa fa-search"></i></span><input type="text" id="search" value="" class="jsx-79190987"/></div><div id="menu-button" class="jsx-79190987"><i class="jsx-79190987 fas fa-bars"></i></div></div></div></div><div id="category" class="jsx-2114829803"><div id="container-category" class="jsx-2114829803"><div id="container-category-fixed" class="jsx-2114829803"><div id="menu-close-button" class="jsx-2114829803"><i class="jsx-2114829803 fas fa-times"></i></div><a id="selected" class="jsx-2114829803" href="/post/react/"><span class="jsx-2114829803">React</span><span class="jsx-2114829803">4</span></a><a class="jsx-2114829803" href="/post/django/"><span class="jsx-2114829803">Django</span><span class="jsx-2114829803">3</span></a><a class="jsx-2114829803" href="/post/javascript/"><span class="jsx-2114829803">Javascript</span><span class="jsx-2114829803">0</span></a><a class="jsx-2114829803" href="/post/python/"><span class="jsx-2114829803">Python</span><span class="jsx-2114829803">0</span></a><a class="jsx-2114829803" href="/post/htmlcss/"><span class="jsx-2114829803">Html CSS</span><span class="jsx-2114829803">1</span></a><a class="jsx-2114829803" href="/post/backend/"><span class="jsx-2114829803">Backend</span><span class="jsx-2114829803">3</span></a><a class="jsx-2114829803" href="/post/devlogs/"><span class="jsx-2114829803">dev logs</span><span class="jsx-2114829803">5</span></a></div></div></div><div id="content"><div class="container"><div class="post-card"><div><h1>How to set state with data from apollo grapqhQL query</h1><p>by Moondaddi on 2018-09-08</p><hr/><h2>Prefill the form with query data</h2><ul><li>prefill values into form or render data into DOM after query</li><li>modify data after query</li></ul><br/><h2>Solution 1</h2><h3>in componentDidMount()</h3><pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { Query } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-apollo&quot;</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  state = {
    <span class="hljs-attr">some</span>: <span class="hljs-literal">null</span>
  };

  componentDidMount() {
    <span class="hljs-keyword">this</span>._queryMe
      .query({
        <span class="hljs-attr">query</span>: other - query,
        <span class="hljs-attr">variables</span>: { <span class="hljs-attr">some</span>: thing }
      })
      .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
        <span class="hljs-keyword">this</span>.setState({
          <span class="hljs-attr">some</span>: data.me.nickname
        });
      })
      .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(error));
  }

  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Query</span> <span class="hljs-attr">query</span>=<span class="hljs-string">{some</span> <span class="hljs-attr">-</span> <span class="hljs-attr">query</span>}&gt;</span>
        {({ client }) =&gt; {
          this._queryMe = client;

          return null;
        }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Query</span>&gt;</span></span>
    );
  }
}</code></pre><h3>props function : onCompleted</h3><pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>
<span class="hljs-keyword">import</span> { Query } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-apollo&#x27;</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  state = {
    <span class="hljs-attr">some</span>: <span class="hljs-literal">null</span>
  }

  _queryMe = <span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
    <span class="hljs-keyword">this</span>.setState({
      <span class="hljs-attr">some</span>: data
    })
  }

  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Query</span>
        <span class="hljs-attr">query</span>=<span class="hljs-string">{some-query}</span>
        <span class="hljs-attr">onCompleted</span>=<span class="hljs-string">{data</span> =&gt;</span> this.\_queryMe(data)}
      &gt;
        {() =&gt; {
          return null;
        }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Query</span>&gt;</span></span>
    )
  }
}</code></pre><br/><h2>Solution 2 (The BEST 👍)</h2><p>Using HOC withApollo</p><pre><code class="hljs language-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  state = {
    <span class="hljs-attr">some</span>: <span class="hljs-literal">null</span>
  };

  componentDidMount() {
    <span class="hljs-keyword">this</span>.props.client
      .query({
        <span class="hljs-attr">query</span>: some_query,
        <span class="hljs-attr">variables</span>: {
          <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>
        }
      })
      .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span>
        <span class="hljs-keyword">this</span>.setState({
          <span class="hljs-attr">some</span>: res
        })
      );
  }

  render() {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }
}

<span class="hljs-comment">// using HOC</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> withApollo(Example);</code></pre></div></div></div></div><div id="footer" class="jsx-1792980523"><div class="jsx-1792980523 footer-container"><div class="jsx-1792980523 footer-left-span"></div><div class="jsx-1792980523 copyright"><div class="jsx-1792980523">Copyright © 2018 Moondaddi&#x27;s Blog</div><div class="jsx-1792980523">The source code is under MIT License</div></div><div class="jsx-1792980523 footer-right-span"><a href="mailto:woonki.moon@gmail.com" class="jsx-1792980523"><i class="jsx-1792980523 fas fa-envelope"></i></a><a href="https://github.com/mattdamon108" target="_blank" class="jsx-1792980523"><i class="jsx-1792980523 fab fa-github"></i></a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/post","query":{"category":"react","page":"1","filename":"2018-09-08-How-to-set-state-with-data-from-graphQL-query"},"buildId":"ppfu4rpZUOMljsYC9ZmK9","nextExport":true}</script><script async="" id="__NEXT_PAGE__/post" src="/_next/static/ppfu4rpZUOMljsYC9ZmK9/pages/post.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/_next/static/ppfu4rpZUOMljsYC9ZmK9/pages/_app.js"></script><script src="/_next/static/runtime/webpack-f0c6edbea5b547edc23f.js" async=""></script><script src="/_next/static/chunks/commons.298c115416bea8464748.js" async=""></script><script src="/_next/static/runtime/main-ea256225ecf9df19827a.js" async=""></script></body></html>