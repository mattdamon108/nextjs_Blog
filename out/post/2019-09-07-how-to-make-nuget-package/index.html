<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" class="next-head"/><title class="jsx-1456713024 next-head">Build the Codes</title><link rel="preload" href="/_next/static/cd2mogbwlZRqpe75PnWcK/pages/post.js" as="script"/><link rel="preload" href="/_next/static/cd2mogbwlZRqpe75PnWcK/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/cd2mogbwlZRqpe75PnWcK/pages/_error.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-2ef50c24cc8d478adafc.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.a12a0474b926b46f4c53.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-2b823ec0a1afc8fe201c.js" as="script"/><style id="__jsx-3700472044">.header-container.jsx-3700472044{position:relative;margin:0 1rem;}
#header-title.jsx-3700472044{display:inline-block;font-family:var(--text-san-serif);font-size:1.4rem;margin:1rem auto;font-weight:bold;}
#header-title.jsx-3700472044 a.jsx-3700472044{-webkit-text-decoration:none;text-decoration:none;}
#header-body.jsx-3700472044{display:inline-block;position:absolute;right:0;margin:1rem auto;text-align:right;}
#menu.jsx-3700472044{display:inline-block;font-size:0.9rem;}
#menu.jsx-3700472044 #header-blog.jsx-3700472044{display:inline-block;margin:auto 1rem;}
#menu.jsx-3700472044 #header-tag.jsx-3700472044{display:inline-block;margin:auto 1rem;}
@media (max-width:576px){#header-title.jsx-3700472044{margin:1rem auto 0 auto;}#header-body.jsx-3700472044{display:block;text-align:right;position:relative;margin:0 auto;}}</style><style id="__jsx-583156192">#header.jsx-583156192{background-color:var(--background-color);color:white;}
.header-container.jsx-583156192{margin:0 1rem;padding:1rem 0;}
#header-title.jsx-583156192{display:block;position:relative;font-family:var(--text-san-serif);font-size:1.7rem;margin:1rem auto;font-weight:bold;}
#header-title.jsx-583156192 a.jsx-583156192{color:white;-webkit-text-decoration:none;text-decoration:none;}
#avatar-img.jsx-583156192{display:inline-block;-webkit-border-radius:25px;-moz-border-radius:25px;border-radius:25px;width:50px;height:50px;background-size:contain;background-repeat:no-repeat;background-position:center center;vertical-align:middle;}
#profile.jsx-583156192{display:inline-block;vertical-align:middle;padding-left:1rem;font-family:$font-serif;color:$text-normal-color;font-size:0.9rem;}
#header-body.jsx-583156192{position:relative;}
#menu.jsx-583156192{display:inline-block;position:absolute;right:0;font-family:$font-serif;font-size:0.9rem;margin-top:1rem;}
#menu.jsx-583156192 #header-tag.jsx-583156192{display:inline-block;margin:auto 1rem;}</style><style id="__jsx-967710577">#footer.jsx-967710577{background-color:var(--background-color);}
.container.jsx-967710577{width:null;}
.footer-container.jsx-967710577{-webkit-flex:1;-ms-flex:1;flex:1;padding:1rem;font-size:0.9rem;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}
.footer-body.jsx-967710577{font-family:var(--text-serif);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}
#footer-menu.jsx-967710577,#footer-contact.jsx-967710577,#footer-online.jsx-967710577{-webkit-flex:1;-ms-flex:1;flex:1;color:white;}
#footer-contact.jsx-967710577 div.jsx-967710577,#footer-online.jsx-967710577 div.jsx-967710577{text-align:center;}
.footer-copyright.jsx-967710577{color:white;}
@media screen and (max-width:576px){.footer-body.jsx-967710577{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}#footer-contact.jsx-967710577 div.jsx-967710577,#footer-online.jsx-967710577 div.jsx-967710577{text-align:left;}}
@media screen and (max-width:1200px){.container.jsx-967710577{width:null;}}</style><style id="__jsx-1456713024">html,body{width:100%;margin:0;padding:0;border:0;--background-color:#222f3e;--text-serif:Merriweather,Courier,serif;--text-san-serif:"Ubuntu","Helvetica Neue",Helvetica,Arial, sans-serif;--text-link-color:#ed4c67;}
body{font-size:1rem;font-family:var(--text-serif);font-weight:300;width:100%;line-height:200%;-webkit-font-smoothing:antialiased;}
a{-webkit-text-decoration:underline;text-decoration:underline;}
a:link{color:var(--text-link-color);}
a:visited{color:var(--text-link-color);}
a:hover{color:var(--text-link-color);}
a:active{color:var(--text-link-color);}
.container{width:800px;margin:0 auto;}
@media (max-width:900px){.container{width:100%;margin:0 auto;}}
.post-content{background-color:#fff;padding:1rem;margin-bottom:50px;}
img{width:100%;max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content;}
blockquote{margin:0;padding:0 1em;color:#6a737d;border-left:0.25em solid #dfe2e5;word-break:break-word;}
code{padding:2px 3px;border-width:0;border-radius:3px;background-color:rgba(255,229,100,0.2);font-family:Merriweather,Courier,serif;}
pre code{overflow:auto;word-wrap:normal;white-space:pre;line-height:150%;}
.hljs-comment,.hljs-quote{color:#d4d0ab;}
.hljs-variable,.hljs-template-variable,.hljs-tag,.hljs-name,.hljs-selector-id,.hljs-selector-class,.hljs-regexp,.hljs-deletion{color:#ffa07a;}
.hljs-number,.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-type,.hljs-params,.hljs-meta,.hljs-link{color:#f5ab35;}
.hljs-attribute{color:#ffd700;}
.hljs-string,.hljs-symbol,.hljs-bullet,.hljs-addition{color:#abe338;}
.hljs-title,.hljs-section{color:#00e0e0;}
.hljs-keyword,.hljs-selector-tag{color:#dcc6e0;}
.hljs{display:block;overflow-x:auto;background:#2b2b2b;color:#f8f8f2;padding:1rem;font-family:Consolas,Menlo,Monaco,monospace;font-size:0.8rem;font-weight:600;border-radius:5px;}
.hljs-emphasis{font-style:italic;}
.hljs-strong{font-weight:bold;}
@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-string,.hljs-symbol,.hljs-type,.hljs-quote{color:highlight;}.hljs-keyword,.hljs-selector-tag{font-weight:bold;}}
@media (max-width:576px){pre{width:100%;}}</style><meta name="author" content="moondaddi"/><link rel="apple-touch-icon" sizes="57x57" href="/static/favicons/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/static/favicons/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/static/favicons/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/static/favicons/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/static/favicons/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/static/favicons/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/static/favicons/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/static/favicons/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/static/favicons/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/static/favicons/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#222f3e"/><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"/><link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Merriweather" rel="stylesheet"/><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=&quot;UA-136784454-1&quot;"></script><script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
          dataLayer.push(arguments);
        }
        gtag("js", new Date());
        gtag("config", "UA-136784454-1");
			</script><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="Build my dreams with codes"/><meta name="theme-color" content="#222f3e"/></head><body><div id="__next"><div id="header" class="jsx-3700472044"><div class="jsx-3700472044 container"><div class="jsx-3700472044 header-container"><div id="header-title" class="jsx-3700472044"><a href="/" class="jsx-3700472044">Build the Codes</a></div><div id="header-body" class="jsx-3700472044"><div id="menu" class="jsx-3700472044"><div id="header-blog" class="jsx-3700472044"><a href="/blog" class="jsx-3700472044">Blog</a></div><div id="header-tag" class="jsx-3700472044"><a href="/tag" class="jsx-3700472044">Tags</a></div></div></div></div></div></div><div id="content"><div class="container"><div class="post-content"><div><h1>How to make a NuGet package for class library</h1><p>by moondaddi on 07 Sep 2019</p><hr/><h2>NuGet</h2><p><a href="https://www.nuget.org/packages/PasswordHasher.SHA256.ASP.NET.CORE.Identity/">https://www.nuget.org/packages/PasswordHasher.SHA256.ASP.NET.CORE.Identity/</a></p><h2>Purpose</h2><p>This is to show how to pack the external class library into NuGet package and publish it on NuGet.org.</p><h2>Background</h2><p>My team decided to build a new indentity api for auth and control roles of each client apis. We chose the <code>IdentityServer4</code> on ASP.NET Core. But we had to migrate all users information including password which is stored in DB. <code>IdentityServer4</code> has a default password hasher <code>PBKDF2</code>. Hence, we decided to override this password hasher with custom hasher which is <code>SHA256</code> and <code>BASE64</code> encoding. We built the custom password hasher as the external class library and published it to NuGet for later use and maintanence.</p><h2>Requirements</h2><ul><li>macOS</li><li>dotnet CLI</li></ul><h2>Steps</h2><ol><li>Install the dotnet CLI</li></ol><p><a href="https://dotnet.microsoft.com/download">https://dotnet.microsoft.com/download</a></p><ol start="2"><li>Create the class library</li></ol><pre><code class="hljs language-shell"><span class="hljs-meta">example$</span><span class="bash"> dotnet new classlib -n SHA256.Password.Hasher</span></code></pre><blockquote><p>This makes a directory <code>SHA256.Password.Hasher</code> and create a template for class library</p></blockquote><ol start="3"><li>Build the class library</li></ol><pre><code class="hljs language-csharp"><span class="hljs-keyword">using</span> System;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">SHA256.Password.Hasher</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CustomPasswordHasher</span>
    {
        <span class="hljs-comment">// ...</span>
    }
}</code></pre><blockquote><p>Rename the class or file (default filename : Class1.cs)</p></blockquote><ol start="4"><li>Add the new class library into <code>.sln</code> file</li></ol><pre><code class="hljs language-shell"><span class="hljs-meta">example$</span><span class="bash"> dotnet new sln</span></code></pre><blockquote><p>Generate the <code>.sln</code> file if not exists</p></blockquote><pre><code class="hljs language-shell"><span class="hljs-meta">example$</span><span class="bash"> dotnet sln add SHA256.Password.Hasher/SHA256.Password.Hasher.csproj</span></code></pre><blockquote><p>Add the <code>SHA256.Password.Hasher</code> into <code>.sln</code></p></blockquote><ol start="5"><li>Add the reference into the main cs project to use the class library</li></ol><pre><code class="hljs language-shell">example/IdentityServer4$ dotnet add reference ../SHA256.Password.Hasher/SHA256.Password.Hasher.csproj

example/IdentityServer4$ dotnet restore</code></pre><ol start="6"><li>Build the class library</li></ol><pre><code class="hljs language-shell">example/SHA256.Password.Hasher$ dotnet build</code></pre><ol start="7"><li>Set the properties for NuGet package information</li></ol><pre><code class="hljs language-csharp"><span class="hljs-meta"># SHA256.Password.Hasher.csproj</span>
 
&lt;Project Sdk=<span class="hljs-string">&quot;Microsoft.NET.Sdk&quot;</span>&gt;
 
  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp2<span class="hljs-number">.2</span>&lt;/TargetFramework&gt;
    &lt;PackageId&gt;PasswordHasher.SHA256.ASP.NET.CORE.Identity&lt;/PackageId&gt;
    &lt;Version&gt;<span class="hljs-number">1.0</span><span class="hljs-number">.1</span>&lt;/Version&gt;
    &lt;Authors&gt;moondaddi&lt;/Authors&gt;
    &lt;RepositoryUrl&gt;https:<span class="hljs-comment">//github.com/mattdamon108/PasswordHasher.SHA256.ASP.NET.CORE.Identity.git&lt;/RepositoryUrl&gt;</span>
  &lt;/PropertyGroup&gt;
 
  &lt;ItemGroup&gt;
    &lt;PackageReference Include=<span class="hljs-string">&quot;Microsoft.AspNetCore.Identity&quot;</span> Version=<span class="hljs-string">&quot;2.2.0&quot;</span> /&gt;
    &lt;PackageReference Include=<span class="hljs-string">&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot;</span> Version=<span class="hljs-string">&quot;2.2.0&quot;</span> /&gt;
  &lt;/ItemGroup&gt;
 
&lt;/Project&gt;</code></pre><ol start="8"><li>Pack the class library to .nupkg file</li></ol><pre><code class="hljs language-shell">example/SHA256.Password.Hasher$ dotnet pack</code></pre><blockquote><p>This generate a <code>.nupkg</code> file</p></blockquote><ol start="9"><li><p>Create NuGet.org account and upload the <code>.nupkg</code> file</p></li><li><p>References</p></li></ol><ul><li><a href="https://docs.microsoft.com/ko-kr/nuget/quickstart/create-and-publish-a-package-using-the-dotnet-cli">https://docs.microsoft.com/ko-kr/nuget/quickstart/create-and-publish-a-package-using-the-dotnet-cli</a></li><li><a href="https://docs.microsoft.com/ko-kr/nuget/create-packages/creating-a-package-dotnet-cli">https://docs.microsoft.com/ko-kr/nuget/create-packages/creating-a-package-dotnet-cli</a></li><li><a href="https://docs.microsoft.com/ko-kr/nuget/nuget-org/publish-a-package">https://docs.microsoft.com/ko-kr/nuget/nuget-org/publish-a-package</a></li><li>Using Visual Studio to make a package<ul><li><a href="https://www.devtrends.co.uk/blog/creating-your-first-shared-library-in-.net-core">https://www.devtrends.co.uk/blog/creating-your-first-shared-library-in-.net-core</a></li></ul></li><li><a href="https://docs.microsoft.com/ko-kr/dotnet/core/tools/csproj">https://docs.microsoft.com/ko-kr/dotnet/core/tools/csproj</a></li></ul></div></div></div></div><div id="header" class="jsx-583156192"><div class="jsx-583156192 container"><div class="jsx-583156192 header-container"><div id="header-title" class="jsx-583156192"><a href="/" class="jsx-583156192">Build the Codes</a></div><div id="header-body" class="jsx-583156192"><div id="avatar-img" style="background-image:url(&quot;/static/images/avatar/moondaddi_avatar.jpg&quot;)" class="jsx-583156192"></div><div id="profile" class="jsx-583156192"><div id="name" class="jsx-583156192"><a href="/" class="jsx-583156192">moondaddi</a></div><div class="jsx-583156192">My dreams with Codes</div></div><div id="menu" class="jsx-583156192"><div id="header-tag" class="jsx-583156192"><a href="/tag" class="jsx-583156192">Tags</a></div></div></div></div></div></div><div id="footer" class="jsx-967710577"><div class="jsx-967710577 container"><div class="jsx-967710577 footer-container"><div class="jsx-967710577 footer-body"><div id="footer-menu" class="jsx-967710577"><div class="jsx-967710577">moondaddi</div><div id="footer-email" class="jsx-967710577"><a href="mailto:woonki.moon@gmail.com" class="jsx-967710577">woonki.moon@gmail.com</a></div></div><div id="footer-contact" class="jsx-967710577"><div class="jsx-967710577"><a href="/blog" class="jsx-967710577">Blog</a></div><div class="jsx-967710577"><a href="/tag" class="jsx-967710577">Tag</a></div></div><div id="footer-online" class="jsx-967710577"><div class="jsx-967710577"><a href="https://github.com/mattdamon108" target="_blank" class="jsx-967710577">Github</a></div><div class="jsx-967710577"><a href="https://www.linkedin.com/in/woonki-moon-150a8b25/" target="_blank" class="jsx-967710577">Linkedin</a></div></div></div><div class="jsx-967710577 footer-copyright"><div class="jsx-967710577">Copyright (c) 2019 moondaddi</div><div class="jsx-967710577">under license MIT</div></div></div></div></div></div><script>__NEXT_DATA__ = {"props":{"pageProps":{}},"page":"/post","query":{"filename":"2019-09-07-how-to-make-nuget-package"},"buildId":"cd2mogbwlZRqpe75PnWcK","nextExport":true};__NEXT_LOADED_PAGES__=[];__NEXT_REGISTER_PAGE=function(r,f){__NEXT_LOADED_PAGES__.push([r, f])}</script><script async="" id="__NEXT_PAGE__/post" src="/_next/static/cd2mogbwlZRqpe75PnWcK/pages/post.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/_next/static/cd2mogbwlZRqpe75PnWcK/pages/_app.js"></script><script async="" id="__NEXT_PAGE__/_error" src="/_next/static/cd2mogbwlZRqpe75PnWcK/pages/_error.js"></script><script src="/_next/static/runtime/webpack-2ef50c24cc8d478adafc.js" async=""></script><script src="/_next/static/chunks/commons.a12a0474b926b46f4c53.js" async=""></script><script src="/_next/static/runtime/main-2b823ec0a1afc8fe201c.js" async=""></script></body></html>