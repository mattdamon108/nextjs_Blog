{"version":3,"file":"static/webpack/static/development/pages/post.js.2f85a6e4d2d6613200ca.hot-update.js","sources":["webpack:///./posts/2019-01-11-Deploy-Nextjs-app-to-AWS-Lambda.md"],"sourcesContent":["\n  import React from 'react'\n  import { MDXTag } from '@mdx-js/tag'\n  \nexport const title = \"How to Deploy the Next.js app to AWS Lambda\"\nexport const createdAt = \"2019-01-11T00:00:00.000Z\"\nexport const filename = \"2019-01-11-Deploy-Nextjs-app-to-AWS-Lambda\"\nexport const category = [\"react\"]\nexport const tag = [\"next\",\"aws\",\"lambda\"]\nexport const thumb = \"2019-01-11_thumb.png\"\nexport const slug = \"with Apex up\"\n\nconst layoutProps = {\n  title,\ncreatedAt,\nfilename,\ncategory,\ntag,\nthumb,\nslug\n};\nexport default class MDXContent extends React.Component {\n  constructor(props) {\n    super(props)\n    this.layout = null\n  }\n  render() {\n    const { components, ...props } = this.props\n\n    return <MDXTag\n             name=\"wrapper\"\n             \n             components={components}><MDXTag name=\"h1\" components={components}>{`How to deploy the Next.js to AWS Lambda`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`by moondaddi on 2019-01-11`}</MDXTag>\n<MDXTag name=\"hr\" components={components}></MDXTag>\n<MDXTag name=\"p\" components={components}>{`This is a tiny example to show how to deploy the Next.js app on AWS Lambda using `}<MDXTag name=\"a\" components={components} parentName=\"p\" props={{\"href\":\"https://up.docs.apex.sh/#introduction\"}}>{`Apex Up`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"h2\" components={components}>{`Next.js app with custom server`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`The custom server for Next.js app is needed to run your app on AWS Lambda. In this example, `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`express`}</MDXTag>{` will be used.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"hljs language-javascript\"}}><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-comment\"}}>{`// server.js`}</MDXTag>{`\n\n`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`const`}</MDXTag>{` express = `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-built_in\"}}>{`require`}</MDXTag>{`(`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"express\"`}</MDXTag>{`);\n`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`const`}</MDXTag>{` next = `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-built_in\"}}>{`require`}</MDXTag>{`(`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"next\"`}</MDXTag>{`);\n\n`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`const`}</MDXTag>{` port = `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-built_in\"}}>{`parseInt`}</MDXTag>{`(process.env.PORT, `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-number\"}}>{`10`}</MDXTag>{`) || `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-number\"}}>{`3000`}</MDXTag>{`;\n`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`const`}</MDXTag>{` dev = process.env.NODE_ENV !== `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"production\"`}</MDXTag>{`;\n`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`const`}</MDXTag>{` app = next({ dev });\n`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`const`}</MDXTag>{` handle = app.getRequestHandler();\n\napp\n  .prepare()\n  .then(`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-function\"}}><MDXTag name=\"span\" components={components} parentName=\"span\" props={{\"className\":\"hljs-params\"}}>{`()`}</MDXTag>{` =>`}</MDXTag>{` {\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`const`}</MDXTag>{` server = express();\n\n    server.get(`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"/\"`}</MDXTag>{`, (req, res) => {\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`return`}</MDXTag>{` app.render(req, res, `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"/\"`}</MDXTag>{`, req.params);\n    });\n\n    server.get(`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"/about\"`}</MDXTag>{`, (req, res) => {\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`return`}</MDXTag>{` app.render(req, res, `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"/about\"`}</MDXTag>{`, req.params);\n    });\n\n    server.get(`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"*\"`}</MDXTag>{`, (req, res) => {\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`return`}</MDXTag>{` handle(req, res);\n    });\n\n    server.listen(port, err => {\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`if`}</MDXTag>{` (err) `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-keyword\"}}>{`throw`}</MDXTag>{` err;\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-built_in\"}}>{`console`}</MDXTag>{`.log(`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\\`> Ready on http://localhost:`}<MDXTag name=\"span\" components={components} parentName=\"span\" props={{\"className\":\"hljs-subst\"}}>{`\\${port}`}</MDXTag>{`\\``}</MDXTag>{`);\n    });\n  })\n  .catch(`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-function\"}}><MDXTag name=\"span\" components={components} parentName=\"span\" props={{\"className\":\"hljs-params\"}}>{`ex`}</MDXTag>{` =>`}</MDXTag>{` {\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-built_in\"}}>{`console`}</MDXTag>{`.log(ex);\n    process.exit(`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-number\"}}>{`1`}</MDXTag>{`);\n  });`}</MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components}>{`update `}<MDXTag name=\"inlineCode\" components={components} parentName=\"h2\">{`package.json`}</MDXTag>{` with custom `}<MDXTag name=\"inlineCode\" components={components} parentName=\"h2\">{`server.js`}</MDXTag></MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"hljs language-json\"}}>{`{\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"scripts\"`}</MDXTag>{`: {\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"dev\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"node server.js\"`}</MDXTag>{`,\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"build\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"next build\"`}</MDXTag>{`,\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"start\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"NODE_ENV=production node server.js\"`}</MDXTag>{`\n  }\n}`}</MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components}>{`Install Apex Up`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"hljs language-shell\"}}><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-meta\"}}>{`$`}</MDXTag><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"bash\"}}>{` curl -sf https://up.apex.sh/install | sh`}</MDXTag>{`\n`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-meta\"}}>{`\n#`}</MDXTag><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"bash\"}}>{` verify the installation`}</MDXTag>{`\n`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-meta\"}}>{`$`}</MDXTag><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"bash\"}}>{` up version`}</MDXTag></MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components}>{`AWS credentials`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`You need to have one AWS account and recommend to use IAM with programmaic way for security and convinience. If you have already installed `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`awscli`}</MDXTag>{` or `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`awsebcli`}</MDXTag>{`, etc. You are having `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`~/.aws/credentials`}</MDXTag>{` which is storing AWS credentials. It allows you to use `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`AWS_PROFILE`}</MDXTag>{` environment. If you don't please make one and save it with your account `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`access key`}</MDXTag>{` and `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`security key`}</MDXTag>{` in it.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"hljs language-shell\"}}><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-meta\"}}>{`#`}</MDXTag><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"bash\"}}>{` ~/.aws/credentials`}</MDXTag>{`\n\n[my-aws-account-for-lambda]\naws_access_key = xxxxxxxxxxxxx\naws_secret_access_key = xxxxxxxxxxxxxxxxxxxx`}</MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components}>{`IAM policy for Up CLI`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`IAM policy allows the Up to access your AWS resources in order to deploy your Next.js app on Lambda. Go to `}<MDXTag name=\"a\" components={components} parentName=\"p\" props={{\"href\":\"https://aws.amazon.com/iam/\"}}>{`AWS IAM`}</MDXTag>{` and make the new policy and link it up to your AWS account.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"hljs language-json\"}}>{`{\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"Version\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"2012-10-17\"`}</MDXTag>{`,\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"Statement\"`}</MDXTag>{`: [\n    {\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"Effect\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"Allow\"`}</MDXTag>{`,\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"Action\"`}</MDXTag>{`: [\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"acm:*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"cloudformation:Create*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"cloudformation:Delete*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"cloudformation:Describe*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"cloudformation:ExecuteChangeSet\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"cloudformation:Update*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"cloudfront:*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"cloudwatch:*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"ec2:*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"ecs:*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"events:*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"iam:AttachRolePolicy\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"iam:CreatePolicy\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"iam:CreateRole\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"iam:DeleteRole\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"iam:DeleteRolePolicy\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"iam:GetRole\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"iam:PassRole\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"iam:PutRolePolicy\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"lambda:AddPermission\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"lambda:Create*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"lambda:Delete*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"lambda:Get*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"lambda:InvokeFunction\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"lambda:List*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"lambda:RemovePermission\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"lambda:Update*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"logs:Create*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"logs:Describe*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"logs:FilterLogEvents\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"logs:Put*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"logs:Test*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"route53:*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"route53domains:*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"s3:*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"ssm:*\"`}</MDXTag>{`,\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"sns:*\"`}</MDXTag>{`\n      ],\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"Resource\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"*\"`}</MDXTag>{`\n    },\n    {\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"Effect\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"Allow\"`}</MDXTag>{`,\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"Action\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"apigateway:*\"`}</MDXTag>{`,\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"Resource\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"arn:aws:apigateway:*::/*\"`}</MDXTag>{`\n    }\n  ]\n}`}</MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components}>{`Create `}<MDXTag name=\"inlineCode\" components={components} parentName=\"h2\">{`up.json`}</MDXTag>{` file`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"hljs language-json\"}}>{`{\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"name\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"nextjs-example\"`}</MDXTag>{`,\n  # aws account profile in ~/.aws/credentials\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"profile\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"my-aws-account-for-lambda\"`}</MDXTag>{`,\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"regions\"`}</MDXTag>{`: [`}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"ap-northeast-2\"`}</MDXTag>{`],\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"lambda\"`}</MDXTag>{`: {\n    # min 128, default 512\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"memory\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-number\"}}>{`256`}</MDXTag>{`,\n    # AWS Lambda supports node.js 8.10 latest\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"runtime\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"nodejs8.10\"`}</MDXTag>{`\n  },\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"proxy\"`}</MDXTag>{`: {\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"command\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"npm start\"`}</MDXTag>{`,\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"timeout\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-number\"}}>{`25`}</MDXTag>{`,\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"listen_timeout\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-number\"}}>{`15`}</MDXTag>{`,\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"shutdown_timeout\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-number\"}}>{`15`}</MDXTag>{`\n  },\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"stages\"`}</MDXTag>{`: {\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"development\"`}</MDXTag>{`: {\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"proxy\"`}</MDXTag>{`: {\n        `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"command\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"yarn dev\"`}</MDXTag>{`\n      }\n    }\n  },\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"environment\"`}</MDXTag>{`: {\n    # you can hydrate env variables as you want.\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"NODE_ENV\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"production\"`}</MDXTag>{`\n  },\n  `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"error_pages\"`}</MDXTag>{`: {\n    `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"variables\"`}</MDXTag>{`: {\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"support_email\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"admin@my-email.com\"`}</MDXTag>{`,\n      `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-attr\"}}>{`\"color\"`}</MDXTag>{`: `}<MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-string\"}}>{`\"#2986e2\"`}</MDXTag>{`\n    }\n  }\n}`}</MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components}>{`Build the Next.js app before deploy`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"hljs language-shell\"}}><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-meta\"}}>{`$`}</MDXTag><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"bash\"}}>{` yarn build`}</MDXTag></MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components}>{`Create `}<MDXTag name=\"inlineCode\" components={components} parentName=\"h2\">{`.upignore`}</MDXTag>{` file`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`The Up will inspect your files to compose and deploy to lambda. Firstly The up will read `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`.gitignore`}</MDXTag>{` and ignore files written in `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`.gitignore`}</MDXTag>{`. And after that, `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`.upignore`}</MDXTag>{` will be read. The Up, by default, ignores dotfiles, so needs to negate `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`.next`}</MDXTag>{` directory in `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`.upignore`}</MDXTag>{` in order for the Up will build the package with it.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"hljs language-shell\"}}><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-meta\"}}>{`#`}</MDXTag><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"bash\"}}>{` .upignore`}</MDXTag>{`\n\n!.next`}</MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components}>{`Deploy`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"hljs language-shell\"}}><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"hljs-meta\"}}>{`$`}</MDXTag><MDXTag name=\"span\" components={components} parentName=\"code\" props={{\"className\":\"bash\"}}>{` up`}</MDXTag></MDXTag></MDXTag>\n\n\n\n\n\n\n\n           </MDXTag>\n  }\n}\nMDXContent.isMDXComponent = true\n  "],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AACA;AAQA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAGA;AACA;;;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AAHA;AAGA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;;;;AArLA;AACA;AADA;AAuLA;;;;A","sourceRoot":""}